## 参考资料

* 离散数学及其应用 - 翻译版, 包括 "离散数学" 和组合数学 / 初等数论 /... - 4

## 组合数学

### 基础

* 乘积法则 / 求和法则求组合
* 减法法则 (容斥原理) A 并 B=A+B-A 交 B
* 除法法则 类似计数时重复计算, 最终结果需要除以重复次
* 鸽巢原理 n 个分 k 份至少有一份数量 >=(n/k)

#### 排列组合

* n 个中排列 r 个 n!/(n-r)! A (n,r)
* n 个中组合 r 个 A (n,r)/r! C (n,r)
* C(n,r) = C(n,n-r)
* 二项式定理
* 字典序生成排列
* 比特串生成组合

#### 结论

* r 从 0 到 k 求和 C (n,r) = 2^n
* 奇数项与偶数项和一样 = 2^(n-1)
* r 从 0 到 k 求和 (2^K)\*C (n,r) = 3^n
* 帕斯卡恒等式 C (n+1,r) = C (n,r) + C (n,r-1) 杨辉三角
* 范德蒙德恒等式 C (m+n,r) = k 从 0 到 r 求和 (C (m,r-k)\*C (n,k)) (r<=m\&r<=n)  当 m=n=r 时得其推论
* C (n+1,r+1) = j 从 r 到 n 求和 C (j,r) 显然 r<=n

#### 允许重复的排列组合

* n 个中排列 r 个 n^r
* n 个中组合 r 个 C (n+r-1,r)
* 集合存在相同元素时, 排列数为 n!/ 所有相同数
* 将 n 个相同元素分为 k 组, 每组物体数量为 Ri, 则有 n!/(R1!R2!...)

#### 错位排列

* D(n) = n!\*(1-1/1!+1/2!-1/3!+...+(-1)^n/n!)

### 递推关系

#### 常系数齐次线性递推关系

* 一定存在 r^n 形式的解 (通项公式)
* 对于 an = c1 _a(n-1)+c2_a(n-2)+...+ck\*a(n-k)
  * r^k-c1_r^(k-1)-c2_r^(k-2)-...-c (k-1)\*r-k=0 为其特征方程
  * r 为方程的根即特征根
  * 多个特征根的线性组合也是解
* 当特征方程存在二重根时, 则其解为 c1_r^k1+c2_n\*r^k2

#### 常系数非齐次线性递推关系

* 对于 an = c1 _a(n-1)+c2_a(n-2)+...+ck\*a(n-k)+F(n)
* 求解其相伴的齐次线性递推关系得通解 anh
* 解为 anh 与 anp (一个特解) 的线性组合

#### 主定理

* 略

### 生成函数

#### 概念

* 生成函数是以一个数列的变形作为不同幂次项的系数的多项式和式
* 普通生成函数指数列项直接为系数
* 它显然是数学工具

#### 广义二项式

* 将 C (n,k) 中 n 推广为实数
* 广义二项式定理 对于 abs (x)<1 的 x, 与任意 n,(1+x)^n = k 从 0 到 n 求和 (广义 C (n,k)\*x^k) 显然是以 C (n,k) 为通项的数列的生成函数

### 组合数学补充

#### 斐波那契数列

* 卢卡斯数列 (L (n)) 是以 2,1 开始的斐波那契数列 (F (n))
* 注意到 L (n)^2 - 5\*F (n)^2 = -4
* 以斐波那契数列相邻两项作为输入会使欧几里德算法达到最坏复杂度
* `2 * L(m+n) = 5 * F(m) * F(n) - L(m)*L(n)`
* `2 * F(m+n) = F(m) * L(n) + L(m) * F(n)`

#### 斯特林数

* 第二种斯特林数 S (n,k) 表示将 n 个不同的元素分成 k 个非空集合的方案数
* S(n,k) = S(n-1,k-1) + k\*S(n-1,k)
* 第一种斯特林数 s (n,k) 表示将 n 个不同的元素分成 k 个非空轮换的方案数
* 一组元素 (n 个) 的轮换是指将这组元素的排列顺序循环右移一位得到的 n 个排列
* s(n,k) = s(n-1,k-1) + (n-1)\*s(n-1,k)
